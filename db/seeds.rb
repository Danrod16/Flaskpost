# This file should contain all the record creation needed to seed the database with its default values.
# The data can then be loaded with the rails db:seed command (or created alongside the database with db:setup).
#
# Examples:
#
#   movies = Movie.create([{ name: 'Star Wars' }, { name: 'Lord of the Rings' }])
#   Character.create(name: 'Luke', movie: movies.first)

# require 'seed_partials/_users_list'

@users_list = [
  {
    first_name: "Alexander",
    last_name: "Hollmann",
    # photo: "https://res.cloudinary.com/kl3000/image/upload/v1575630948/user_profile_images/T02NE0241-UPM08BB4G-e03b376ab89c-512_ud9mzo.jpg"
    # address: "Frankfurt, Germany"
  },
  {
    first_name: "Alexandru",
    last_name: "Sima",
    # photo: "https://res.cloudinary.com/kl3000/image/upload/v1575630972/user_profile_images/T02NE0241-UP7UZUUTC-285ae1d2dce5-512_o0pvwi.jpg"
    # address: "Clot, Barcelona"
  },
  {
    first_name: "Andrés",
    last_name: "Ramos",
    # photo: "https://res.cloudinary.com/kl3000/image/upload/v1575630984/user_profile_images/T02NE0241-UPLK9PZ2R-381c9c64d4d1-512_vx01ze.jpg"
    # address: "Verdaguer, Barcelona"
  },
  {
    first_name: "Angelica",
    last_name: "De Moffarts",
    # photo: "https://res.cloudinary.com/kl3000/image/upload/v1575631032/user_profile_images/T02NE0241-UP96TAG67-9eb3437bec64-512_tlonji.jpg"
    # address: "Ghent, Belgium"
  },
  {
    first_name: "Avalon",
    last_name: "Van Der Horst",
    # photo: "https://res.cloudinary.com/kl3000/image/upload/v1575631328/user_profile_images/T02NE0241-U8314BQ82-01c1dcf7eca3-512_jmkpyi.jpg"
    # address: "Koninklijk Paleis, Amsterdam"
  },
  {
    first_name: "Ben",
    last_name: "Toosey",
    # photo: "https://res.cloudinary.com/kl3000/image/upload/v1575631375/user_profile_images/T02NE0241-UPL535Y6Q-cc4875c7306c-512_ht297e.jpg"
    # address: "Buckingham, UK"
  },
  {
    first_name: "Camille",
    last_name: "Bonnet",
    # photo: "https://res.cloudinary.com/kl3000/image/upload/v1575631397/user_profile_images/T02NE0241-U7NAVD676-9fbc275d84b3-512_vuaiva.jpg"
    # address: "Paris, France"
  },
  {
    first_name: "Cassandre",
    last_name: "Houzé De L'Aulnoit",
    # photo: "https://res.cloudinary.com/kl3000/image/upload/v1575631397/user_profile_images/T02NE0241-U7NAVD676-9fbc275d84b3-512_vuaiva.jpg"
    # address: "Lille, France"
  },
  {
    first_name: "Christos",
    last_name: "Kaltaveridis",
    # photo: "https://res.cloudinary.com/kl3000/image/upload/v1575631481/user_profile_images/T02NE0241-UPL897MJ8-e50ac5a48da9-512_iop3oz.png"
    # address: "Cardiff, UK"
  },
  {
    first_name: "Claire",
    last_name: "Dinsart",
    # photo: "https://res.cloudinary.com/kl3000/image/upload/v1575631499/user_profile_images/T02NE0241-UHBDC0J3C-a773b355ed2c-512_dp7k1c.png"
    # address: "Bordeaux, France"
  },
  {
    first_name: "Claire",
    last_name: "Gautier",
    # photo: "https://res.cloudinary.com/kl3000/image/upload/v1575631519/user_profile_images/T02NE0241-UA0DUPP0E-025a8aae0543-512_mkeo2u.jpg"
    # address: "Brest, France"
  },
  {
    first_name: "Edward",
    last_name: "Jacobs",
    # photo: "https://res.cloudinary.com/kl3000/image/upload/v1575631539/user_profile_images/T02NE0241-UPE6G9J49-d22621b165bd-512_fhpewx.jpg"
    # address: "Kansas, US"
  },
  {
    first_name: "Elena",
    last_name: "Perez",
    # photo: "https://res.cloudinary.com/kl3000/image/upload/v1575631636/user_profile_images/T02NE0241-UPNSBGT0W-c173a85e1293-512_jmfmsw.jpg"
    # address: "Placa Reial, Barcelona"
  },
  {
    first_name: "Elise",
    last_name: "Navarro",
    # photo: "https://res.cloudinary.com/kl3000/image/upload/v1575631659/user_profile_images/T02NE0241-UPL53A45S-d67170dcd996-512_l5rdiy.jpg"
    # address: "Chicago, US"
  },
  {
    first_name: "Ellyn",
    last_name: "Bouscasse",
    # photo: "https://res.cloudinary.com/kl3000/image/upload/v1575631683/user_profile_images/T02NE0241-U4598RZGF-b92abaa9d3bf-512_osyidq.jpg"
    # address: "Carrer d'En Grassot, Barcelona"
  },
  {
    first_name: "Gabriel",
    last_name: "Constantin Ursache",
    # photo: "https://res.cloudinary.com/kl3000/image/upload/v1575631767/user_profile_images/T02NE0241-UPL6PFTA8-77844c4dfb36-512_vcs2sh.png"
    # address: "Bucharest, Romania"
  },
  {
    first_name: "Gijs",
    last_name: "Maks",
    # photo: "https://res.cloudinary.com/kl3000/image/upload/v1575631794/user_profile_images/T02NE0241-UPL4NQ8DS-2b931133ac94-512_c7a661.jpg"
    # address: "Amsterdam, Netherlands"
  },
  {
    first_name: "Gus",
    last_name: "De Vita",
    # photo: "https://res.cloudinary.com/kl3000/image/upload/v1575631854/user_profile_images/T02NE0241-U0CAK1T88-81f976504e1c-512_b8tobm.jpg"
    # address: "Carrer d'en Grassot, Barcelona"
  },
  {
    first_name: "Hamza",
    last_name: "M'Barek",
    # photo: "https://res.cloudinary.com/kl3000/image/upload/v1575631890/user_profile_images/T02NE0241-UPNR72TP0-ae9ed4ff472c-512_lfwhae.jpg"
    # address: "Paris, France"
  },
  {
    first_name: "Iñaki",
    last_name: "Mediavilla",
    # photo: "https://res.cloudinary.com/kl3000/image/upload/v1575631965/user_profile_images/T02NE0241-UP7R4UMTL-a8948787a53c-512_pa33xz.png"
    # address: "Bilbao, Spain"
  },
  {
    first_name: "Isac",
    last_name: "Giuk Kim",
    # photo: "https://res.cloudinary.com/kl3000/image/upload/v1575632170/user_profile_images/T02NE0241-UPLK2131N-e1b9f6081978-512_bcsftl.png"
    # address: "Quito, Ecuador"
  },
  {
    first_name: "Ivana",
    last_name: "Piljic",
    # photo: "https://res.cloudinary.com/kl3000/image/upload/v1575632262/user_profile_images/T02NE0241-UPE8T7BMF-d221df9b7ce2-512_j6wwur.jpg"
    # address: "Zadar, Croatia"
  },
  {
    first_name: "Malou",
    last_name: "Allertz",
    # photo: "https://res.cloudinary.com/kl3000/image/upload/v1575632348/user_profile_images/T02NE0241-U281EAB8D-6bd41d7b2018-512_lugths.png"
    # address: "Leiden, Netherlands"
  },
  {
    first_name: "Miguel Ángel",
    last_name: "Marfil Rubio",
    # photo: "https://res.cloudinary.com/kl3000/image/upload/v1575632434/user_profile_images/T02NE0241-UPE7M99U1-32151dfec812-512_xfqpoh.jpg"
    # address: "Placa Catalunya, Barcelona"
  },
  {
    first_name: "Mireia",
    last_name: "Palmero",
    # photo: "https://res.cloudinary.com/kl3000/image/upload/v1575632531/user_profile_images/T02NE0241-UPNEUMKCP-2be77693c771-512_c0wedv.jpg"
    # address: "Barceloneta, Barcelona"
  },
  {
    first_name: "Nicholas",
    last_name: "Jardine",
    # photo: "https://res.cloudinary.com/kl3000/image/upload/v1575632608/user_profile_images/T02NE0241-UP7T3D858-a61e60b3df53-512_qiihnf.jpg"
    # address: "Johannesburg, South Africa"
  },
  {
    first_name: "Nico",
    last_name: "Standup",
    # photo: "https://res.cloudinary.com/kl3000/image/upload/v1575632684/user_profile_images/T02NE0241-UKPKXKN3V-63e484c7b1df-512_hke0lb.jpg"
    # address: "Arc de Triomf, Barcelona"
  },
  {
    first_name: "Ollie",
    last_name: "Senduk",
    # photo: "https://res.cloudinary.com/kl3000/image/upload/v1575632761/user_profile_images/T02NE0241-U2965HDS9-855f9fbf052e-512_qytqoi.jpg"
    # address: "Rijksmuseum, Amsterdam"
  },
  {
    first_name: "Pablo",
    last_name: "Maisuls",
    # photo: "https://res.cloudinary.com/kl3000/image/upload/v1575632840/user_profile_images/T02NE0241-UPL530BJ8-71dcd1eab182-512_snomcx.png"
    # address: "Park Güell, Barcelona"
  },
  {
    first_name: "Roy",
    last_name: "Souvereyns",
    # photo: "https://res.cloudinary.com/kl3000/image/upload/v1575632956/user_profile_images/T02NE0241-UPNNQ4SQ7-7a67b587c825-512_i1goyi.png"
    # address: "Brussels, Belgium"
  },
  {
    first_name: "Sandra",
    last_name: "Carmona Serrat",
    # photo: "https://res.cloudinary.com/kl3000/image/upload/v1575633072/user_profile_images/T02NE0241-UPNR00MJS-3f78e18209ea-512_pzuxot.jpg"
    # address: "Tibidabo, Barcelona"
  },
  {
    first_name: "Sarah",
    last_name: "Ma",
    # photo: "https://res.cloudinary.com/kl3000/image/upload/v1575633188/user_profile_images/T02NE0241-UPNR02CCE-79f183a257a3-512_buopuu.jpg"
    # address: "Los Angeles, US"
  },
  {
    first_name: "Smruthi",
    last_name: "Lattupalli",
    # photo: "https://res.cloudinary.com/kl3000/image/upload/v1575633315/user_profile_images/T02NE0241-UPE3UGVHP-ca0511be2cc0-512_njvjve.jpg"
    # address: "Joanic, Barcelona"
  },
  {
    first_name: "Thomas",
    last_name: "Julien",
    # photo: "https://res.cloudinary.com/kl3000/image/upload/v1575633440/user_profile_images/T02NE0241-UP9P145FU-5c9d7959b92f-512_dkkh5s.jpg"
    # address: "Avignon, France"
  },
  {
    first_name: "Veronika",
    last_name: "Wajda",
    # photo: "https://res.cloudinary.com/kl3000/image/upload/v1575633583/user_profile_images/T02NE0241-UPNSFK57Y-fded15e76e1f-512_wcspvd.jpg"
    # address: "Calgary, Canada"
  },
  {
    first_name: "Humbeline",
    last_name: "De Marcillac",
    # photo: "https://res.cloudinary.com/kl3000/image/upload/v1575633722/user_profile_images/T02NE0241-UP7SKR550-27db0832a318-512_xy6law.jpg"
    # address: "Marcillac, France"
  },
  {
    first_name: "Glen",
    last_name: "Warren",
    # photo: "https://res.cloudinary.com/kl3000/image/upload/v1575633856/user_profile_images/T02NE0241-UL37H2W9L-a2b642e6c3d4-512_htrphc.jpg"
    # address: "Shoreditch, London"
  },
  {
    first_name: "Daniel",
    last_name: "Landes",
    # photo: "https://res.cloudinary.com/kl3000/image/upload/v1575635966/user_profile_images/T02NE0241-UP7SKTM0S-5cd01d3cbc2a-512_pz6zsa.jpg"
    # address: "Westminster, London"
  }
]

@companies_list = [
  {
    name: "Google",
    domain: "google.com",
    address: "1600 Amphitheatre Parkway, Mountain View, California, United States",
    photo: "https://storage.googleapis.com/gd-wagtail-prod-assets/original_images/evolving_google_identity_share.jpg"
  },
  {
    name: "Facebook",
    domain: "facebook.com",
    address: "1 Hacker Way, Menlo Park, California, United States",
    photo: "https://about.fb.com/wp-content/uploads/2019/11/facebook_wordmark.gif"
  },
  {
    name: "Twitter",
    domain: "twitter.com",
    address: "1355 Market Street, San Francisco, California, United States",
    photo: "https://s3.amazonaws.com/img.mynetdiary.com/src/logo_twitter.png"
  },
  {
    name: "Skyscanner",
    domain: "skyscanner.net",
    address: "Quartermile One, 15 Lauriston Place, Edinburgh, United Kingdom",
    photo: "https://mundoxdescubrir.com/wp-content/uploads/2019/02/logo-skyscanner-1.png"
  },
  {
    name: "Booking.com",
    domain: "booking.com",
    address: "Herengracht 597, Amsterdam, Netherlands",
    photo: "https://www.vilacvetka.com/wp-content/uploads/2015/04/booking.com-logo-2.png"
  },
  {
    name: "AirBnB",
    domain: "airbnb.com",
    address: "888 Brannan St, San Francisco, California, United States",
    photo: "http://www.brandemia.org/sites/default/files/sites/default/files/bnb_billboard_01-2000x1125.jpg"
  },
  {
    name: "Microsoft Iberia",
    domain: "microsoft.com",
    address: "Edificio B3, Carrer de Josep Pla, 2, Barcelona",
    photo: "http://img-prod-cms-rt-microsoft-com.akamaized.net/cms/api/am/imageFileData/RE2qVsJ?ver=3f74"
  },
  {
    name: "Yego",
    domain: "yego.es",
    address: "Carrer de Wellington, 94, Barcelona",
    photo: "https://is3-ssl.mzstatic.com/image/thumb/Purple123/v4/c3/d6/03/c3d60344-cc7b-c6fd-fbc1-a564be66391b/AppIcon-0-0-1x_U007emarketing-0-0-0-10-0-0-85-220.png/1200x630wa.png"
  },
  {
    name: "ThoughtWorks",
    domain: "thoughtworks.com",
    address: "Edifici Media-TIC, Carrer de Roc Boronat, 117, Barcelona",
    photo: "https://sonarplusd.com/system/attached_images/21482/medium/ThoughtWorks-Alta.jpg?1519817056"
  },
  {
    name: "eCooltra",
    domain: "ecooltra.com",
    address: "Carrer de la Reina Cristina, 2, Barcelona",
    photo: "https://canelapr.com/wp-content/uploads/2017/06/ecooltra-logo.jpg"
  },
  {
    name: "Revolut",
    domain: "revolut.com",
    address: "7 Westferry Circus, Canary Wharf, London, United Kingdom",
    photo: "https://upload.wikimedia.org/wikipedia/commons/c/c9/Logo_Revolut.png"
  },
  {
    name: "N26",
    domain: "n26.com",
    address: "Klosterstraße 62, Berlin, Germany",
    photo: "http://fintechaustria.org/wp-content/uploads/2018/07/n26-logo.png"
  },
  {
    name: "Typeform",
    domain: "typeform.com",
    address: "Carrer de Bac de Roda, 163, Barcelona",
    photo: "https://upload.wikimedia.org/wikipedia/commons/thumb/6/67/Typeform_Logo.svg/1200px-Typeform_Logo.svg.png"
  },
  {
    name: "Marfeel",
    domain: "marfeel.com",
    address: "Av. de Josep Tarradellas, 20, Barcelona",
    photo: "https://pbs.twimg.com/profile_images/1047789743335989248/a-QyWwKU_400x400.jpg"
  },
  {
    name: "Cabify",
    domain: "cabify.com",
    address: "Calle de Pradillo, 42, Madrid",
    photo: "https://upload.wikimedia.org/wikipedia/commons/5/58/Cabify-logo-purple.png"
  },
  {
    name: "Le Wagon",
    domain: "lewagon.com",
    address: "16 Villa Gaudelet, Paris, France",
    photo: "https://mk0mindspacemexmwc0q.kinstacdn.com/wp-content/uploads/sites/2/2017/03/white_logo_red_font.png"
  },
  {
    name: "Badi",
    domain: "badi.com",
    address: "Passeig de Garcia Fària, 49, Barcelona",
    photo: "https://media.licdn.com/dms/image/C4D0BAQG7h7FmPFXZTA/company-logo_200_200/0?e=2159024400&v=beta&t=UnYwVD5kc1F7ZJSx8ppGKgdxn4S1YMlO8xoyxT9QpXo"
  }
]

@domains = ["gmail.com", "hotmail.com", "outlook.com"]

def clear_database
  puts "CLEARING DATABASE:"
  puts " "

  puts "Destroying Messages..."
  puts "Destroyed #{Message.all.count} Messages."
  Message.destroy_all
  puts " "

  puts "Destroying Matches..."
  puts "Destroyed #{Match.all.count} Matches."
  Match.destroy_all
  puts " "

  puts "Destroying Profiles..."
  puts "Destroyed #{Profile.all.count} Profiles."
  Profile.destroy_all
  puts " "

  puts "Destroying Postings..."
  puts "Destroyed #{Posting.all.count} Postings."
  Posting.destroy_all
  puts " "

  puts "Destroying Users..."
  puts "Destroyed #{User.all.count} Users."
  User.destroy_all
  puts " "

  puts "Destroying Companies..."
  puts "Destroyed #{Company.all.count} Companies."
  Company.destroy_all
  puts " "


  puts "DATABASE CLEARED."
  puts " "
end

def create_users(n_users)
  users_list = @users_list.shuffle
  companies_list = @companies_list.shuffle

  n_users.times do

    selected_user_index = users_list.length - 1
    p selected_user = users_list[selected_user_index]
    users_list.delete_at(selected_user_index)

    if companies_list.length > 0 # new users will be associated to company if there are still companies available to be allocated (recruiters)

      selected_company_index = companies_list.length - 1
      selected_company = companies_list[selected_company_index]
      companies_list.delete_at(selected_company_index) if rand(10) <= 5 # probabilistic variation of employers per company

      email = "#{selected_user[:first_name].downcase.gsub(/\s+/, "")}.#{selected_user[:last_name].downcase.gsub(/\s+/, "")}@#{selected_company[:domain]}"

      existing_company = Company.find_by(name: selected_company[:name])

      if existing_company # if company exists user will be associated with it

        new_user = User.new(
          email: email,
          password: "12341234",
          first_name: selected_user[:first_name],
          last_name: selected_user[:last_name],
          company_id: existing_company.id)

          if new_user.valid?
            new_user.save
            p User.last
          else
            p new_user.errors.messages
          end

      else # if company does not exist, a new company will be created

        new_company = Company.new(
          name: selected_company[:name],
          address: selected_company[:address])

        if new_company.valid?
          new_company.save
          p new_company
        else
          p new_company.errors.messages
        end

        new_user = User.new( # and the new user will be created with association to the new company here
          email: email,
          password: "12341234",
          first_name: selected_user[:first_name],
          last_name: selected_user[:last_name],
          company_id: new_company.id)

        if new_user.valid?
          new_user.save
          p User.last
        else
          p new_user.errors.messages
        end
      end

    else # remaining new users will not be associated with a company (applicants)

      email = "#{selected_user[:first_name].downcase.gsub(/\s+/, "")}.#{selected_user[:last_name].downcase.gsub(/\s+/, "")}@#{@domains.sample}"

    end

    new_user = User.new( # and will be created without company association here
      email: email,
      password: "12341234",
      first_name: selected_user[:first_name],
      last_name: selected_user[:last_name])

    if new_user.valid?
      new_user.save
      p User.last
    else
      p new_user.errors.messages
    end

  end
end

def seed_database
  puts "SEEDING DATABASE"
  puts " "

  puts "Seeding Users..."
  puts " "

  create_users(@users_list.length)

  # n_users.times do
  #   selected_user = @users_list.sample
  #   new_user = User.new(
  #     email: "#{selected_user[:first_name]}.#{selected_user[:last_name]}@#{@domains.sample}",
  #     password: "12341234",
  #     first_name: selected_user[:first_name],
  #     last_name: selected_user[:last_name])
  #   if new_user.valid?
  #     new_user.save
  #     p User.last
  #     seed_loan_offers(rand(0..3), selected_user)
  #   else
  #     p new_user.errors.messages
  #   end
  # end
  # p "#{User.count} Users."

end

clear_database
seed_database

